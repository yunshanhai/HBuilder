<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>交互式入门</title>
	</head>
	<body>
    <p id="para1">原生点击document.getElementById('xx').onclick=function(){...}</p>
    <p id="para2">d3.select('xx').on('click', function(){...})</p>
    <p id="para3">d3同一事件多个监听器click.first click.second click.xx...</p>
    <p id="para4">d3移除监听器d3.select('xx').on('click',null)（点击一次后移除）</p>
    <script src="js/d3.v3.js"></script>
    <script src="js/common.js"></script>
    <script>
      //原生添加点击事件
      var para = document.getElementById('para1');
      para.onclick = function(){
        this.innerHTML = 'Thank you';
      }
      
      //d3添加点击事件
      d3.select('#para2').on('click', function(){
        d3.select(this).text('Thank you');
      })
      
      //d3同一事件添加多个监听器(事件.name name随便设)
      d3.select('#para3').on('click', function(){
        cl('first click');
      }).on('click.second', function(){
        cl('second click');
      }).on('click.xx', function(){
        cl('click.xx');
      })
      
      //移除监听器
      d3.select('#para4').on('click', function(){
        cl('click then remove');
        //移除
        d3.select(this).on('click', null);
      });
      
      //！！事件监听器要设置在transition()之前
      cl(d3.ascending(2,2))
      
      function demo1(){
        var characters = ['A', 'S', 'D', 'F'];
        var svg = d3.select('body').append('svg')
          .attr('width', 300)
          .attr('height', 3000);
        var rects = svg.selectAll('rect')
          .data(characters)
          .enter()
          .append('rect')
          .attr('x', function(d,i){return 10 + i * 60; })
          .attr('y', 10)
          .attr('width', 55)
          .attr('height', 55)
          .attr('rx', 5)
          .attr('ry', 5)
          .attr('fill', 'black');
        var texts = svg.selectAll('text')
          .data(characters)
          .enter()
          .append('text')
          .attr('x', function(d,i){ return 10 + i * 60; })
          .attr('y', 10)
          .attr('dx', 10)
          .attr('dy', 25)
          .attr('fill', 'white')
          .attr('font-size', 24)
          .text(function(d,i){return d;});
          
        d3.select('body').on('keydown',function(){
          rects.attr('fill', function(d){
            if(d == String.fromCharCode(d3.event.keyCode)){
              return 'yellow';
            }else{
              return 'black';
            }
          })
        }).on('keyup', function(){
          rects.attr('fill', 'black');
        });
      }
      demo1();
    </script>
	</body>
</html>
